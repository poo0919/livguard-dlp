
<!DOCTYPE html>
<html class=" ">
    <head>
        <!-- 
         * @Package: Complete Admin - Responsive Theme
         * @Subpackage: Bootstrap
         * @Version: 2.2
         * This file is part of Complete Admin Theme.
        -->
        <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
        <meta charset="utf-8" />
        <title>LivGuard</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta content="" name="description" />
        <meta content="" name="author" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        
        <link rel="shortcut icon" href="../assets/images/favicon.png" type="image/x-icon" />    <!-- Favicon -->
        <link rel="apple-touch-icon-precomposed" href="../assets/images/apple-touch-icon-57-precomposed.png">   <!-- For iPhone -->
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/images/apple-touch-icon-114-precomposed.png">    <!-- For iPhone 4 Retina display -->
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/images/apple-touch-icon-72-precomposed.png">    <!-- For iPad -->
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/images/apple-touch-icon-144-precomposed.png">    <!-- For iPad Retina display -->



        <!-- CORE CSS FRAMEWORK - START -->
        <link href="assets/plugins/pace/pace-theme-flash.css" rel="stylesheet" type="text/css" media="screen"/>
        <link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
        <link href="assets/plugins/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css"/>
        <link href="assets/fonts/font-awesome/css/font-awesome.css" rel="stylesheet" type="text/css"/>
        <link href="assets/css/animate.min.css" rel="stylesheet" type="text/css"/>
        <link href="assets/plugins/perfect-scrollbar/perfect-scrollbar.css" rel="stylesheet" type="text/css"/>
        <!-- CORE CSS FRAMEWORK - END -->

        <!-- HEADER SCRIPTS INCLUDED ON THIS PAGE - START --> 
        
        
<link href="assets/plugins/prettyphoto/prettyPhoto.css" rel="stylesheet" type="text/css" media="screen"/>

        <!-- HEADER SCRIPTS INCLUDED ON THIS PAGE - END --> 


        <!-- CORE CSS TEMPLATE - START -->
        <link href="assets/css/style.css" rel="stylesheet" type="text/css"/>
        <link href="assets/css/responsive.css" rel="stylesheet" type="text/css"/>
        <!-- CORE CSS TEMPLATE - END -->
        <style type="text/css">
            .Banner{
                height: 250px;width:464px;margin-left:-15px !important;border-bottom: 1px solid #606060;
            }
        </style>
        <link href="assets/css/index-style.css" rel="stylesheet" type="text/css"/>

    </head>
    <!-- END HEAD -->

    <!-- BEGIN BODY -->
    <body class=" "><!-- START TOPBAR -->
<div class='page-topbar '>
    <div class='logo-area'>

    </div>
    <div class='quick-area'>
        <div class='pull-left'>
            <ul class="info-menu left-links list-inline list-unstyled">
                <li class="sidebar-toggle-wrap">
                    <a href="#" data-toggle="sidebar" class="sidebar_toggle">
                        <i class="fa fa-bars"></i>
                    </a>
                </li>
            </ul>
        </div>		
        <div class='pull-right'>
            <ul class="info-menu right-links list-inline list-unstyled">
                <li class="profile">
                    <a href="#" data-toggle="dropdown" class="toggle">
                    <!--    <img src="../data/profile/profile.jpg" alt="user-image" class="img-circle img-inline"> -->
                        <span id="adminFirstName"> <i class="fa fa-angle-down"></i></span>
                    </a>
                    <ul class="dropdown-menu profile animated fadeIn">
                    <!--    <li>
                            <a href="#settings">
                                <i class="fa fa-wrench"></i>
                                Settings
                            </a>
                        </li>
                        <li>
                            <a href="#profile">
                                <i class="fa fa-user"></i>
                                Profile
                            </a>
                        </li>
                        <li>
                            <a href="#help">
                                <i class="fa fa-info"></i>
                                Help
                            </a>
                        </li>  -->
                        <li class="last">
                            <a href="admin-login.html">
                                <i class="fa fa-lock"></i>
                                Logout
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>			
        </div>		
    </div>

</div>
<!-- END TOPBAR 
 START CONTAINER -->
<div class="page-container row-fluid container-fluid">

    <!-- SIDEBAR - START -->

<div class="page-sidebar ">

    <!-- MAIN MENU - START -->
    <div class="page-sidebar-wrapper" id="main-menu-wrapper"> 
        <ul class='wraplist' >	
                    <li class="" style="padding-top: 40px;"> 
                    <a href="home.html">
                    <img src="assets/images/home.png" style="padding-left: 5px;">
                    <span class="title" style="padding-left: 15px;"> Home</span>
                        </a>
                    </li>
                    <li class="" > 
                    <a href="dealers-purchase-records.html">
                    <img src="assets/images/dealers-purchase-records.png" style="padding-left: 5px;">
                    <span class="title" style="padding-left: 15px;"> Dealers & Purchase Records</span>
                        </a>
                    </li>
                    <li class=""  >
                    <a href="customer-product-warranty-list.html">
                    <img src="assets/images/customer-product-warranty-list.png" style="padding-left: 5px;">
                    <span class="title" style="padding-left: 14px;"> Customer & Product Warranty</span>
                        </a>
                    </li>
                    <li class="open" > 
                    <a href="notifications.html">
                    <img src="assets/images/notifications.png" style="padding-left: 5px;">
                    <span class="title" style="padding-left: 15px;">Send Notifications</span>
                        </a>
                    </li>
                    <li class="" > 
                    <a href="loyalty-scheme.html">
                    <img src="assets/images/loyalty-scheme.png" style="padding-left: 5px;">
                    <span class="title" style="padding-left: 15px;"> Loyalty Scheme</span>
                        </a>
                    </li>
                    <li class="">
                    <a href="application-chart.html">
                    <img src="assets/images/application-chart.png" style="padding-left: 5px;">
                    <span class="title" style="padding-left: 15px;"> Application Chart</span>
                        </a>
                    </li>
        </ul>



    </div>
    <!-- MAIN MENU - END -->



</div>
<!--  SIDEBAR - END -->
    <!-- START CONTENT -->
<section id="main-content" class=" ">
    <section class="wrapper main-wrapper row" style=''>

  
    <!-- MAIN CONTENT AREA STARTS -->
    <div class="col-lg-12">
    <section class="box ">
            <header class="panel_header">
                <h2 class="title pull-left">Pushed News & Notification</h2>
                <div class="actions panel_actions pull-right"><br>
                    
                    <a href="#myModal" data-toggle="modal" class="btn" style="height: 40px;width: 120px;background-color: #EB5757;color:#ffffff;font-size: 16px;"><img src="assets/images/notifications.png"> Add New</a>
                </div>
            </header><br><br><br>
            <div class="content-body">    <div class="row" id="notificationData">

            </div>
            </div>
        </section></div>
<!-- MAIN CONTENT AREA ENDS -->
    </section>
    </section>
    <!-- END CONTENT -->
  
    <!-- END CONTAINER -->
<!-- LOAD FILES AT PAGE END FOR FASTER LOADING -->


<!-- CORE JS FRAMEWORK - START --> 
<script src="assets/js/jquery-1.11.2.min.js" type="text/javascript"></script> 
<script src="assets/js/jquery.easing.min.js" type="text/javascript"></script> 
<script src="assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script> 
<script src="assets/plugins/pace/pace.min.js" type="text/javascript"></script>  
<script src="assets/plugins/perfect-scrollbar/perfect-scrollbar.min.js" type="text/javascript"></script> 
<script src="assets/plugins/viewport/viewportchecker.js" type="text/javascript"></script>  
<script>window.jQuery||document.write('<script src="assets/js/jquery-1.11.2.min.js"><\/script>');</script>
<!-- CORE JS FRAMEWORK - END --> 


<!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - START --> 

<script src="assets/plugins/prettyphoto/jquery.prettyPhoto.js" type="text/javascript"></script>
<script src="assets/plugins/isotope/jquery.isotope.min.js" type="text/javascript"></script>
<script src="assets/plugins/isotope/jquery.isotope.sloppy-masonry.min.js" type="text/javascript"></script>
<!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - END --> 


<!-- CORE TEMPLATE JS - START --> 
<script src="assets/js/scripts.js" type="text/javascript"></script> 
<!-- END CORE TEMPLATE JS - END --> 


<!-- General section box modal start -->
<div aria-hidden="true"  role="dialog" tabindex="-1" id="myModal" class="modal fade" style="display: none;">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
                                <h4 class="modal-title" style="text-align: center;">Add New Notification</h4>
                            </div>
                            <div class="modal-body">
                                <form role="form" id="add_new_notification_form">

                                    <div class="form-group">
                                        <label for="notification" class="form-label">Title</label>
                                        <input type="text" class="form-control" id="notification" name="notification" >
                                    </div>
                                    <div class="form-group">
                                        <label for="link" class="form-label">Link</label>
                                        <input type="text" class="form-control" id="link" name="link" >
                                    </div>
                                    <div class="form-group">
                                        <label for="description" class="form-label">Description</label>
                                        <textarea class="form-control" id="description" name="description" rows="3" ></textarea>  
                                    </div>
                                    <div class="form-group-inline">
                                        <label for="file" class="form-label">File input</label>
                                        <input type="file" id="file" name="file">
                                        <img id="blah" src="#"  alt="select image" width="100px;" height="100px;" />
                                    </div><br>
                                    
                                    <button type="button" id="add_new_notification_button" class="btn" style="background-color: #EB5757;color:#ffffff;">Submit</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <div aria-hidden="true"  role="dialog" tabindex="-1" id="myModal2" class="modal fade" style="display: none;">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
                                <h4 class="modal-title" style="text-align: center;">Update Notification</h4>
                            </div>
                            <div class="modal-body">
                                <form role="form" id="update_notification_form">
                                <input type="hidden" name="id1" id="id1">
                                    <div class="form-group">
                                        <label for="notification1" class="form-label">Title</label>
                                        <input type="text" class="form-control" id="notification1" name="notification1" >
                                    </div>
                                    <div class="form-group">
                                        <label for="link1" class="form-label">Link</label>
                                        <input type="text" class="form-control" id="link1" name="link1" >
                                    </div>
                                    <div class="form-group">
                                        <label for="description1" class="form-label">Description</label>
                                        <textarea class="form-control" id="description1" name="description1" rows="3" placeholder="Write Description Here"></textarea>  
                                    </div>
                                <!--    <div class="form-group-inline">
                                        <label for="file1" class="form-label">File input</label>
                                        <input type="file" id="file1" name="file1">
                                        <img id="blah1" src="#"  alt="select image" width="100px;" height="100px;" />
                                    </div><br>-->
                                    
                                    <button type="button" id="update_notification_button" class="btn" style="background-color: #EB5757;color:#ffffff;">Submit</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
<!-- modal end -->
<script type="text/javascript">
var files,token;
$(document).ready(function(){

    token=localStorage.getItem('token');

    var adminFirstName=localStorage.getItem('first_name');
    $('#adminFirstName').prepend(adminFirstName);
    
    $('input[type=file]').on('change', prepareUpload);

    $('#add_new_notification_button').click(function(e) {

        e.preventDefault();
        var notification = $("#notification").val();
        var link = $("#link").val();
        var description = $("#description").val();
        var data = new FormData();
        $.each(files, function(key, value)
        {
            data.append('file', value);
        })
        data.append('notification', notification);
        data.append('link', link);
        data.append('description', description);
        data.append('is_active', true);
        

        $.ajax({
            type: 'POST',
            url: 'http://dlpdevelopment-env.ap-south-1.elasticbeanstalk.com/v1/uploadnotification/',
            data: data,
            cache: false,
            //dataType: 'json',
            processData: false, // Don't process the files
            contentType: false,
            headers: {
                        'Authorization':'Token '+token,
                    },
            //async: false,
            //processData:false,
            success: function(msg, status, xhr) {
                console.log('msg,status,xhr',msg,status,xhr);
                window.location.reload();
                //returnValue = msg;
            },
            error: function(xhr,status,error){
                console.log(xhr+status+error);
            }

        });
    });

    $('#update_notification_button').click(function(e) {

        e.preventDefault();
        var notification = $("#notification1").val();
        var link = $("#link1").val();
        var description = $("#description1").val();
        var id = $("#id1").val();
     //   alert(id);
        var data = new FormData();
       /* $.each(files, function(key, value)
        {
            data.append('file', value);
        })*/
        data.append('notification', notification);
        data.append('link', link);
        data.append('description', description);
    //    data.append('is_active', true);
        

        $.ajax({
            type: 'PUT',
            url: 'http://dlpdevelopment-env.ap-south-1.elasticbeanstalk.com/v1/uploadnotification/'+id+'/',
            data: data,
            cache: false,
            //dataType: 'json',
            processData: false, // Don't process the files
            contentType: false,
            headers: {
                        'Authorization':'Token '+token,
                    },
            //async: false,
            //processData:false,
            success: function(msg, status, xhr) {
                console.log('msg,status,xhr',msg,status,xhr);
                window.location.reload();
                //returnValue = msg;
            },
            error: function(xhr,status,error){
                console.log(xhr+status+error);
            }

        });
    });
    

     
     $.ajax({

            url: 'http://dlpdevelopment-env.ap-south-1.elasticbeanstalk.com/v1/notification/',
            type: 'GET',
            headers: {
                'Authorization':'Token '+token,
            },
            success: function(json){

                for (var i=0; i <json.length; i++) {
                    var state,status,bckCol;
                    if(json[i].is_active==true){
                        status="Deactivate";
                        state=false;
                        bckCol="#EB5757";
                    }else{
                        status="Activate";
                        state=true;
                        bckCol="#6FCF97";
                    }
                var markup ='<section class="col-lg-6"  style="border: 1px solid #606060;border-radius: 4px;height:344px;width: 466px;margin-left:25px;margin-top:20px;background-color:#EEEEEE">'+
              
                                '<div class="col-lg-12 Banner"  id="Banner'+json[i].id+'" style="background-image:url('+json[i].small_image+');background-size: 100% 100%;margin-bottom:15px;" >'+
                        
                                '</div>'+


                                '<button style="float:right;color:white;background-color:'+bckCol+';" onclick="changeNotifyState('+state+','+json[i].id+')">'+status+'</button><br>'+
                                '<span onclick=deleteNotification('+json[i].id+') style="color: black;float:right;padding-left:10px;padding-right:10px;cursor:pointer;"><i class="fa fa-trash fa-5x"></i></span>'+
                                '<span id="id" onclick=modalFunction2() data-id="'+json[i].id+'" data-notification1="'+json[i].notification+'" data-link1="'+json[i].link+'" data-description1="'+json[i].description+'" data-img-url="'+json[i].small_image+'" data-toggle="modal" data-target="#myModal2" style="color: black;float:right;cursor:pointer;"><i class="fa fa-pencil fa-5x"></i></span>'+
                                '<div><h4 style="color:black;">'+json[i].notification+'</h4>'+
                                '<p style="color:black;">'+json[i].description+'</p></div>'+
                                '</section>';
                

                                    $('#notificationData').append(markup);
                }
            },
            error: function(xhr,status,error){
                console.log(xhr+status+error);
            }

                            
        });

});

function prepareUpload(event){
    files = event.target.files;
}

function deleteNotification(id){
    var r = confirm("Are you sure you want delete this Notification?");
        if (r == true) {
            $.ajax({
        
                url: 'http://dlpdevelopment-env.ap-south-1.elasticbeanstalk.com/v1/notification/'+id+'/', 
                type: 'DELETE',
                headers: {
                    'Authorization':'Token '+token,
                },
                success: function(msg, status, xhr){
                    console.log(msg+" "+status+" "+xhr);
                    window.location.reload();
                                                        
                },
                error: function(xhr,status,error){
                    console.log(xhr+status+error);
                }
            });
        }
    

}

function readURL(input) {

    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#blah').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
}

function changeNotifyState(state,id){
    var data={
            "is_active":state
        };
    $.ajax({
        
        url: 'http://dlpdevelopment-env.ap-south-1.elasticbeanstalk.com/v1/uploadnotification/'+id+'/', 
        type: 'PUT',
        data: data,
        cache: false,

        headers: {
            'Authorization':'Token '+token,
        },
        success: function(msg, status, xhr){
            console.log(msg+" "+status+" "+xhr);
            window.location.reload();
                                                
        },
        error: function(xhr,status,error){
            console.log(xhr+status+error);
        }
    });

}

$("#file").change(function(){
    readURL(this);
});
/*$("#file1").change(function(){
    readURL(this);
});
$('#id').click(function (e) {
    $('#myModal2 img#blah1').attr('src', $(this).attr('data-img-url'));
});*/
function modalFunction2(){
    //alert("0");;
                     $("#myModal2").on("show.bs.modal", function (event){
                        $('#myModal2').find('input#id1').val($(event.relatedTarget).data('id'));
                        $('#myModal2').find('input#notification1').val($(event.relatedTarget).data('notification1'));
                        $('#myModal2').find('input#link1').val($(event.relatedTarget).data('link1'));
                        $('#myModal2').find('textarea#description1').val($(event.relatedTarget).data('description1'));
                        //alert(val($(event.relatedTarget).data('file1')));
                        //$('#myModal2').find('input#blah').css('src',$().attr('data-img-url'));
                        //$('#myModal2').find('img#blah1').css('src',$(event.relatedTarget).attr('data-file1'));
                       // $('#myModal2 img#blah1').attr('src', $(event.relatedTarget).attr('data-file1'));

                     });
                     
        }
</script>
</body>
</html>



